(this["webpackJsonpcovid19-trofa-graph"]=this["webpackJsonpcovid19-trofa-graph"]||[]).push([[0],{110:function(t,e,a){t.exports=a(240)},115:function(t,e,a){},118:function(t,e){},120:function(t,e){},240:function(t,e,a){"use strict";a.r(e);var n=a(0),r=a.n(n),o=a(7),i=a.n(o),c=(a(115),a(45)),s=a(277),u=a(278),d=a(279),l=a(284),h=a(282),m=a(283),f=a(275),p=a(276),g=a(280),v=a(281),b=a(57),E=a(58),w=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[],i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[];Object(b.a)(this,t),this._confirmedPt=void 0,this._confirmedNorth=void 0,this._newConfirmedPt=void 0,this._activePt=void 0,this._hospitalized=void 0,this._icu=void 0,this._confirmedPt=e,this._confirmedNorth=a,this._newConfirmedPt=n,this._activePt=r,this._hospitalized=o,this._icu=i}return Object(E.a)(t,[{key:"confirmedPt",get:function(){return this._confirmedPt}},{key:"confirmedNorth",get:function(){return this._confirmedNorth}},{key:"newConfirmedPt",get:function(){return this._newConfirmedPt}},{key:"activePt",get:function(){return this._activePt}},{key:"hospitalized",get:function(){return this._hospitalized}},{key:"hospitalizedIcu",get:function(){return this._icu}}]),t}(),y=a(59),_=a(75),P=a.n(_);var C=function(){function t(e,a){Object(b.a)(this,t),this._dateStr=void 0,this._date=void 0,this._count=void 0,this._dateStr=e,this._date=function(t){var e=t.split("-");return new Date(Number(e[2]),Number(e[1])-1,Number(e[0]))}(e),this._count="number"===typeof a?a:parseInt(a),isNaN(this._count)&&(this._count=0)}return Object(E.a)(t,[{key:"dateStr",get:function(){return this._dateStr}},{key:"date",get:function(){return this._date}},{key:"count",get:function(){return this._count}}]),t}();function R(t){var e="https://raw.githubusercontent.com/dssg-pt/covid19pt-data/master/"+t,a=new Headers({Accept:"application/vnd.github.v3+json"});return console.log("[_getDataFromSource] Fetching "+t),fetch(e,{method:"GET",headers:a})}function k(t,e){R("data_concelhos_incidencia.csv").then((function(t){if(t&&200===t.status)return t.text()})).then((function(a){var n=[],r=new y.Readable;r.push(a),r.push(null),r.pipe(P()()).on("data",(function(e){return n.push(new C(e.data,e[t]))})).on("end",(function(){return e(n)}))})).catch((function(t){return console.error(t)}))}function O(t){R("data.csv").then((function(t){if(t&&200===t.status)return t.text()})).then((function(e){var a=[],n=[],r=[],o=[],i=[],c=[],s=new y.Readable;s.push(e),s.push(null),s.pipe(P()()).on("data",(function(t){a.push(new C(t.data,t.confirmados)),n.push(new C(t.data,t.confirmados_arsnorte)),r.push(new C(t.data,t.confirmados_novos)),o.push(new C(t.data,t.ativos)),i.push(new C(t.data,t.internados)),c.push(new C(t.data,t.internados_uci))})).on("end",(function(){return t(new w(a,n,r,o,i,c))}))})).catch((function(t){return console.error(t)}))}var j=a(44),M=a(271);function x(t){var e=window.screen.availWidth,a=12*(t.length/e);return Math.max(4-a,1)}function B(t,e){var a=function(t){var e=new Date;return e.setDate(e.getDate()-t),e}(t);return e.filter((function(t){return t.date>=a}))}function N(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:6;return t.map((function(a,n){var r=Math.max(0,n-e),o=Math.min(t.length,n+e),i=t.slice(r,o),c=i.reduce((function(t,e){return t+e.count}),0);return new C(a.dateStr,Math.round(c/i.length))}))}var S=function(t,e,a){return{datasets:[Object(j.a)({label:e,categoryPercentage:1,barPercentage:.95,lineTension:.1,borderWidth:2,pointBackgroundColor:"#fff",pointHoverBorderColor:"rgba(220,220,220,1)",pointBorderWidth:1,pointHoverRadius:5,pointRadius:x(t),data:t.map((function(t){return t.count}))},a)],labels:t.map((function(t){return t.dateStr}))}},A=function(t,e,a){return{datasets:Array.from(Array(t.length).keys()).map((function(n){return Object(j.a)({label:e[n],categoryPercentage:1,barPercentage:.95,lineTension:.1,borderWidth:2,pointBackgroundColor:"#fff",pointHoverBorderColor:"rgba(220,220,220,1)",pointBorderWidth:1,pointHoverRadius:5,pointRadius:x(t[n]),data:t[n].map((function(t){return t.count}))},a[n])})),labels:t[0].map((function(t){return t.dateStr}))}},z=function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return{maintainAspectRatio:!1,scales:{yAxes:[{ticks:{beginAtZero:t,suggestedMin:e,suggestedMax:a}}]}}},D=0,I=function(t,e){return r.a.createElement(M.a,{item:!0,xs:12,key:D++},r.a.createElement("div",{className:e.chartContainer},t))},T=function(t,e){for(var a=arguments.length,n=new Array(a>2?a-2:0),o=2;o<a;o++)n[o-2]=arguments[o];return r.a.createElement("div",null,r.a.createElement(f.a,{variant:"h3",style:{textAlign:"center"},gutterBottom:!0},t),r.a.createElement(M.a,{container:!0,spacing:3},n.map((function(t){return I(t,e)}))))},W=a(34),H=a(43),q=function(t){var e=t.dataArray,a=t.dateRange,n=t.labels,o=t.themes,i=t.zeroBased,c=e.map((function(t){return B(a,t)})),s=c.flatMap((function(t){return t.map((function(t){return t.count}))})),u=Math.min.apply(Math,Object(W.a)(s)),d=Math.max.apply(Math,Object(W.a)(s)),l=Math.max((d-u)/20,i?4:2),h=Math.round(d+l),m=Math.round(u-l);return i&&(m=Math.max(m,0)),e.length!==n.length||n.length!==o.length?(console.error("Chart arguments cardinality did not match!"),r.a.createElement(H.a,{options:z(!1,m,h)})):r.a.createElement(H.a,{data:A(c,n,o),options:z(i,m,h)})};q.defaultProps={zeroBased:!0,dateRange:0};var F=q;function G(t,e,a){var n=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},o="".concat(t,",").concat(e,",").concat(a);return Object(j.a)({backgroundColor:n?"rgba(".concat(o,",0.4)"):"rgba(0,0,0,0)",borderColor:"rgba(".concat(o,",1)"),pointBorderColor:"rgba(".concat(o,",1)"),pointHoverBackgroundColor:"rgba(".concat(o,",1)")},r)}G(75,192,192);var J=G(192,75,192),U=G(217,128,217),Z=G(140,83,140),$=G(192,192,75),K=G(200,200,200,!1,{pointRadius:0,pointHitRadius:0,borderDash:[8]}),L=G(255,189,0,!1),Q=G(255,84,0,!1),V=G(158,0,89,!1),X=function(t){var e,a=t.trofaEntries,n=t.northEntries,o=t.ptEntries,i=t.dateRange,c=t.classes,s=(e=a,function(t){return e.map((function(e){return new C(e.dateStr,t)}))});return T("Casos novos",c,r.a.createElement(F,{dataArray:[a,s(240),s(480),s(960)],dateRange:i,labels:["Incid\xeancia na Trofa (a 14 dias p/ 100k hab.)","Risco elevado","Risco muito elevado","Risco extremamente elevado"],themes:[$,L,Q,V]}),r.a.createElement(F,{dataArray:[n,N(n)],dateRange:i,labels:["Casos novos no Norte",""],themes:[$,K]}),r.a.createElement(F,{dataArray:[o.newConfirmedPt,N(o.newConfirmedPt)],dateRange:i,labels:["Casos novos em Portugal",""],themes:[$,K]}))},Y=function(t){var e=t.data,a=t.dateRange,n=t.label,o=t.theme,i=t.zeroBased,c=B(a,e),s=Math.min.apply(Math,Object(W.a)(c.map((function(t){return t.count})))),u=Math.max.apply(Math,Object(W.a)(c.map((function(t){return t.count})))),d=Math.max((u-s)/20,i?4:2),l=Math.round(u+d),h=Math.round(s-d);return i&&(h=Math.max(h,0)),r.a.createElement(H.a,{data:S(c,n,o),options:z(i,h,l)})};Y.defaultProps={zeroBased:!0,dateRange:0};var tt=Y,et=function(t){var e=t.ptEntries,a=t.dateRange,n=t.classes;return T("Casos ativos",n,r.a.createElement(tt,{data:e.activePt,dateRange:a,label:"Casos ativos em Portugal",theme:J,zeroBased:!0}),r.a.createElement(F,{dataArray:[e.hospitalized,e.hospitalizedIcu],dateRange:a,labels:["Internados em Portugal","Internados em UCI em Portugal"],themes:[U,Z],zeroBased:!0}))},at=Object(p.a)((function(){return{root:{backgroundColor:"#f5f5f5",flexGrow:1,display:"flex","align-items":"center","justify-content":"center",padding:15,paddingRight:30},chartContainer:{position:"relative",margin:"auto",height:"50vh",width:"90vw"},progress:{float:"none",margin:"0 auto"},appBar:{maxWidth:170,marginBottom:20,backgroundColor:"#e0e0e0"},formControl:{margin:10}}})),nt=function(){var t=at(),e=Object(n.useState)(!0),a=Object(c.a)(e,2),o=a[0],i=a[1],p=Object(n.useState)(60),b=Object(c.a)(p,2),E=b[0],y=b[1],_=Object(n.useState)([]),P=Object(c.a)(_,2),R=P[0],j=P[1],M=Object(n.useState)(new w),x=Object(c.a)(M,2),B=x[0],N=x[1],S="",A="",z=[];return o||(S=R[R.length-1].dateStr,A=B.confirmedPt[B.confirmedPt.length-1].dateStr,z=function(t){for(var e=t[0],a=[new C(e.dateStr,0)],n=1;n<t.length;n++){var r=t[n];a.push(new C(r.dateStr,r.count-e.count)),e=r}return a}(B.confirmedNorth)),Object(n.useEffect)((function(){k("TROFA",j),O(N)}),[]),o&&R.length>0&&B.confirmedPt.length>0&&i(!1),r.a.createElement("div",{className:t.root},o?r.a.createElement(s.a,{className:t.progress}):r.a.createElement("div",null,r.a.createElement(u.a,{position:"sticky",className:t.appBar},r.a.createElement(d.a,{className:t.formControl},r.a.createElement(l.a,{id:"time-label"},"Tempo"),r.a.createElement(h.a,{labelId:"time-label",id:"time-select",value:E,onChange:function(t){return y(t.target.value)}},r.a.createElement(m.a,{value:30},"30 dias"),r.a.createElement(m.a,{value:60},"60 dias"),r.a.createElement(m.a,{value:90},"90 dias"),r.a.createElement(m.a,{value:999999},"Desde sempre")))),r.a.createElement(g.a,null,r.a.createElement(v.a,null,r.a.createElement(f.a,{variant:"body2",component:"p"},"A \xfaltima atualiza\xe7\xe3o destes dados ocorreu nas seguintes datas: ","Portugal/Norte => ".concat(A,", Trofa => ").concat(S),".",r.a.createElement("br",null)))),r.a.createElement("br",null),r.a.createElement(et,{ptEntries:B,dateRange:E,classes:t}),r.a.createElement("br",null),r.a.createElement(X,{trofaEntries:R,dateRange:E,northEntries:z,ptEntries:B,classes:t}),r.a.createElement("br",null),r.a.createElement(g.a,null,r.a.createElement(v.a,null,r.a.createElement(f.a,{variant:"body2",component:"p"},"Os dados aqui apresentados s\xe3o extra\xeddos do reposit\xf3rio ",r.a.createElement("a",{href:"https://github.com/dssg-pt/covid19pt-data"},"dssg-pt/covid19pt-data"),".",r.a.createElement("br",null),"O c\xf3digo para este dashboard pode ser consultado ",r.a.createElement("a",{href:"https://github.com/DiogoDuque/covid19TrofaGraph"},"aqui"),".",r.a.createElement("br",null))))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(r.a.createElement(nt,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(t){t.unregister()}))}},[[110,1,2]]]);
//# sourceMappingURL=main.cc6dd4ee.chunk.js.map