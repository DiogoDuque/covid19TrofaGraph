(this["webpackJsonpcovid19-trofa-graph"]=this["webpackJsonpcovid19-trofa-graph"]||[]).push([[0],{129:function(t,e,n){},132:function(t,e){},134:function(t,e){},258:function(t,e,n){"use strict";n.r(e);var a=n(3),r=n(0),o=n(9),i=n.n(o),c=(n(129),n(13)),s=n(301),u=n(302),_=n(14),d=n(55),l=n(60),f=n(17),g=n(18),b=n(12);var h=function(){function t(e,n){Object(f.a)(this,t),this._dateStr=void 0,this._date=void 0,this._count=void 0,this._dateStr=e,this._date=function(t){var e=t.split("-");return new Date(Number(e[2]),Number(e[1])-1,Number(e[0]))}(e),this._count="number"===typeof n?n:parseInt(n),isNaN(this._count)&&(this._count=0)}return Object(g.a)(t,[{key:"dateStr",get:function(){return this._dateStr}},{key:"date",get:function(){return this._date}},{key:"count",get:function(){return this._count}}]),t}();function j(t){var e=window.screen.availWidth,n=12*(t.length/e);return Math.max(4-n,1)}function O(t,e){var n=function(t){var e=new Date;return e.setDate(e.getDate()-t),e}(t);return e.filter((function(t){return t.date>=n}))}function m(t){for(var e=t[0],n=[new h(e.dateStr,0)],a=1;a<t.length;a++){var r=t[a];n.push(new h(r.dateStr,r.count-e.count)),e=r}return n}function E(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:7;return t.map((function(n,a){var r=Math.max(0,a-e),o=Math.min(t.length,a+e),i=t.slice(r,o),c=i.reduce((function(t,e){return t+e.count}),0);return new h(n.dateStr,Math.round(c/i.length))}))}function p(t,e){return t.map((function(t){var n=Math.round(1e5*t.count/e);return new h(t.dateStr,n)}))}function v(t,e){return function(t,e,n){if(t.length!==e.length||t[0].dateStr!==e[0].dateStr)return console.error("The two Entry[] don't seem mergeable!\n".concat(t,"\n").concat(e)),[];for(var a=[],r=0;r<t.length;r++)a.push(n(t[r],e[r]));return a}(t,e,(function(t,e){return new h(t.dateStr,t.count+e.count)}))}var D={CONFIRMED_0_9:"confirmados_0_9",CONFIRMED_10_19:"confirmados_10_19",CONFIRMED_20_29:"confirmados_20_29",CONFIRMED_30_39:"confirmados_30_39",CONFIRMED_40_49:"confirmados_40_49",CONFIRMED_50_59:"confirmados_50_59",CONFIRMED_60_69:"confirmados_60_69",CONFIRMED_70_79:"confirmados_70_79",CONFIRMED_80_PLUS:"confirmados_80_plus"},C={DEAD_0_9:"obitos_0_9",DEAD_10_19:"obitos_10_19",DEAD_20_29:"obitos_20_29",DEAD_30_39:"obitos_30_39",DEAD_40_49:"obitos_40_49",DEAD_50_59:"obitos_50_59",DEAD_60_69:"obitos_60_69",DEAD_70_79:"obitos_70_79",DEAD_80_PLUS:"obitos_80_plus"},A=Object(b.a)(Object(b.a)(Object(b.a)(Object(b.a)(Object(b.a)({CONFIRMED_PT:"confirmados",CONFIRMED_NORTH:"confirmados_arsnorte",CONFIRMED_CENTER:"confirmados_arscentro",CONFIRMED_LISBOA_TEJO:"confirmados_arslvt",CONFIRMED_ALENTEJO:"confirmados_arsalentejo",CONFIRMED_ALGARVE:"confirmados_arsalgarve",NEWCASES_PT:"confirmados_novos",ACTIVE_PT:"ativos",HOSPITALIZED:"internados",HOSPITALIZED_NURSERY:"internados_enfermaria",HOSPITALIZED_ICU:"internados_uci",DEAD_PT:"obitos"},{CONFIRMED_0_9_F:"confirmados_0_9_f",CONFIRMED_0_9_M:"confirmados_0_9_m",CONFIRMED_10_19_F:"confirmados_10_19_f",CONFIRMED_10_19_M:"confirmados_10_19_m",CONFIRMED_20_29_F:"confirmados_20_29_f",CONFIRMED_20_29_M:"confirmados_20_29_m",CONFIRMED_30_39_F:"confirmados_30_39_f",CONFIRMED_30_39_M:"confirmados_30_39_m",CONFIRMED_40_49_F:"confirmados_40_49_f",CONFIRMED_40_49_M:"confirmados_40_49_m",CONFIRMED_50_59_F:"confirmados_50_59_f",CONFIRMED_50_59_M:"confirmados_50_59_m",CONFIRMED_60_69_F:"confirmados_60_69_f",CONFIRMED_60_69_M:"confirmados_60_69_m",CONFIRMED_70_79_F:"confirmados_70_79_f",CONFIRMED_70_79_M:"confirmados_70_79_m",CONFIRMED_80_PLUS_F:"confirmados_80_plus_f",CONFIRMED_80_PLUS_M:"confirmados_80_plus_m"}),{DEAD_0_9_F:"obitos_0_9_f",DEAD_0_9_M:"obitos_0_9_m",DEAD_10_19_F:"obitos_10_19_f",DEAD_10_19_M:"obitos_10_19_m",DEAD_20_29_F:"obitos_20_29_f",DEAD_20_29_M:"obitos_20_29_m",DEAD_30_39_F:"obitos_30_39_f",DEAD_30_39_M:"obitos_30_39_m",DEAD_40_49_F:"obitos_40_49_f",DEAD_40_49_M:"obitos_40_49_m",DEAD_50_59_F:"obitos_50_59_f",DEAD_50_59_M:"obitos_50_59_m",DEAD_60_69_F:"obitos_60_69_f",DEAD_60_69_M:"obitos_60_69_m",DEAD_70_79_F:"obitos_70_79_f",DEAD_70_79_M:"obitos_70_79_m",DEAD_80_PLUS_F:"obitos_80_plus_f",DEAD_80_PLUS_M:"obitos_80_plus_m"}),D),C),{},{TOWN_INCIDENCE_14:"incidencia",TOWN_CONFIRMED_14:"confirmados_14"}),M=function(){function t(e){Object(f.a)(this,t),this._name=void 0,this._name=e}return Object(g.a)(t,[{key:"getAll",value:function(t){return console.warn("The EntriesAggregator '".concat(this._name,"' was not properly instantiated and is trying to call getAll!")),[]}},{key:"getLast",value:function(t){return console.warn("The EntriesAggregator '".concat(this._name,"' was not properly instantiated and is trying to call getLastEntry!")),new h("",0)}}]),t}(),x=function(t){Object(d.a)(n,t);var e=Object(l.a)(n);function n(t){var a;return Object(f.a)(this,n),(a=e.call(this,t.name))._aggregationMap=void 0,a._aggregationMap=t._aggregator,a}return Object(g.a)(n,[{key:"getAll",value:function(t){return this._aggregationMap[t]||[]}},{key:"getLast",value:function(t){var e=this._aggregationMap[t];return e[e.length-1]}}]),n}(M),N=function(){function t(e){Object(f.a)(this,t),this._name=void 0,this._aggregator=void 0,this._name=e,this._aggregator={}}return Object(g.a)(t,[{key:"addEntry",value:function(t,e){var n=this._aggregator[t]||[];return this._aggregator[t]=[].concat(Object(_.a)(n),[e]),this}},{key:"addEntries",value:function(t,e){var n=this._aggregator[t]||[];return this._aggregator[t]=[].concat(Object(_.a)(n),Object(_.a)(e)),this}},{key:"build",value:function(){return new x(this)}},{key:"name",get:function(){return this._name}}]),t}(),I=function(t){Object(d.a)(n,t);var e=Object(l.a)(n);function n(){return Object(f.a)(this,n),e.apply(this,arguments)}return Object(g.a)(n,[{key:"addByAgeGroup",value:function(t){var e=this;Object.entries(t).forEach((function(t){var n=Object(c.a)(t,2)[1],a=e._aggregator["".concat(n,"_m")],r=e._aggregator["".concat(n,"_f")];e.addEntries(n,v(a,r))}))}},{key:"preProcess",value:function(){this.addByAgeGroup(C),this.addByAgeGroup(D)}},{key:"build",value:function(){return this.preProcess(),new x(this)}}]),n}(N),R=n(72),y=n(90),S=n.n(y);function F(t){var e="https://raw.githubusercontent.com/dssg-pt/covid19pt-data/master/"+t,n=new Headers({Accept:"application/vnd.github.v3+json"});return console.log("[_getDataFromSource] Fetching "+t),fetch(e,{method:"GET",headers:n})}var T=n(290),w=n(294),P=n(295),k=function(t){var e=t.children;return Object(a.jsx)(T.a,{children:Object(a.jsx)(w.a,{children:Object(a.jsx)(P.a,{variant:"body2",component:"p",children:e})})})},L=n(296),B=n(297),W=n(298),H=n(305),U=n(303),z=n(306),G=n(304),V=n(299),J=n(75),Z=new J.a({portugalEntries:new M("DUMMY"),trofaEntries:new M("DUMMY"),dateRange:60}),Y=new J.a({styles:{},tab:0}),q=function(){var t=Y.useState((function(t){return t.styles}));return Object(a.jsx)(L.a,{position:"sticky",className:t.appBar,children:Object(a.jsxs)(B.a,{children:[Object(a.jsxs)(W.a,{className:t.formControl,children:[Object(a.jsx)(H.a,{id:"time-label",children:"Tempo"}),Object(a.jsxs)(U.a,{labelId:"time-label",id:"time-select",value:Z.useState((function(t){return t.dateRange})),onChange:function(t){return Z.update((function(e){e.dateRange=t.target.value}))},children:[Object(a.jsx)(z.a,{value:30,children:"30 dias"}),Object(a.jsx)(z.a,{value:60,children:"60 dias"}),Object(a.jsx)(z.a,{value:90,children:"90 dias"}),Object(a.jsx)(z.a,{value:999999,children:"Desde sempre"})]})]}),Object(a.jsxs)(G.a,{value:Y.useState((function(t){return t.tab})),onChange:function(t,e){return Y.update((function(t){t.tab=e}))},indicatorColor:"primary",textColor:"primary","aria-label":"full width tabs example",children:[Object(a.jsx)(V.a,{label:"Gr\xe1ficos"}),Object(a.jsx)(V.a,{label:"Infos"})]})]})})},$=function(){return Object(a.jsx)(T.a,{children:Object(a.jsx)(w.a,{children:Object(a.jsxs)(P.a,{variant:"body2",component:"p",children:["Os dados aqui apresentados s\xe3o extra\xeddos do reposit\xf3rio ",Object(a.jsx)("a",{href:"https://github.com/dssg-pt/covid19pt-data",children:"dssg-pt/covid19pt-data"}),".",Object(a.jsx)("br",{}),"O c\xf3digo para este dashboard pode ser consultado ",Object(a.jsx)("a",{href:"https://github.com/DiogoDuque/covid19TrofaGraph",children:"aqui"}),".",Object(a.jsx)("br",{})]})})})},K=n(300),Q=function(t,e,n){return{datasets:[Object(b.a)({label:e,categoryPercentage:1,barPercentage:.95,lineTension:.1,borderWidth:2,pointBackgroundColor:"#fff",pointHoverBorderColor:"rgba(220,220,220,1)",pointBorderWidth:1,pointHoverRadius:5,pointRadius:j(t),data:t.map((function(t){return t.count}))},n)],labels:t.map((function(t){return t.dateStr}))}},X=function(t,e,n){return{datasets:Array.from(Array(t.length).keys()).map((function(a){return Object(b.a)({label:e[a],categoryPercentage:1,barPercentage:.95,lineTension:.1,borderWidth:2,pointBackgroundColor:"#fff",pointHoverBorderColor:"rgba(220,220,220,1)",pointBorderWidth:1,pointHoverRadius:5,pointRadius:j(t[a]),data:t[a].map((function(t){return t.count}))},n[a])})),labels:t[0].map((function(t){return t.dateStr}))}},tt=function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return{maintainAspectRatio:!1,scales:{yAxes:[{ticks:{beginAtZero:t,suggestedMin:e,suggestedMax:n}}]}}},et=0,nt=function(t){return Object(a.jsx)(K.a,{item:!0,xs:6,md:3,children:t},et++)},at=function(t,e){return Object(a.jsx)(K.a,{item:!0,xs:12,children:Object(a.jsx)("div",{className:e.chartContainer,children:t})},et++)},rt=function(t,e){for(var n=arguments.length,r=new Array(n>2?n-2:0),o=2;o<n;o++)r[o-2]=arguments[o];return Object(a.jsxs)("div",{children:[Object(a.jsx)(P.a,{variant:"h3",style:{textAlign:"center"},gutterBottom:!0,children:t}),Object(a.jsx)(K.a,{container:!0,spacing:3,children:r.map((function(t){return at(t,e)}))})]})},ot=function(t){var e=t.title,n=t.entry;return Object(a.jsx)(T.a,{elevation:4,children:Object(a.jsxs)(w.a,{children:[Object(a.jsx)(P.a,{style:{fontSize:15,fontWeight:"bold"},color:"textSecondary",gutterBottom:!0,children:e}),Object(a.jsx)(P.a,{variant:"h5",component:"h2",children:n.count}),Object(a.jsx)(P.a,{style:{fontSize:11},color:"textSecondary",children:"\xdaltima atualiza\xe7\xe3o: ".concat(n.dateStr)})]})})},it=function(){var t=Z.useState((function(t){return t.portugalEntries})),e=Z.useState((function(t){return t.trofaEntries}));return function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return Object(a.jsx)(K.a,{container:!0,spacing:1,direction:"row",alignItems:"center",justify:"center",children:e.map((function(t){return nt(t)}))})}(Object(a.jsx)(ot,{title:"Casos ativos em Portugal",entry:t.getLast(A.ACTIVE_PT)}),Object(a.jsx)(ot,{title:"Casos novos em Portugal",entry:t.getLast(A.NEWCASES_PT)}),Object(a.jsx)(ot,{title:"Incid\xeancia na Trofa",entry:e.getLast(A.TOWN_INCIDENCE_14)}),Object(a.jsx)(ot,{title:"Casos novos (14d) na Trofa",entry:e.getLast(A.TOWN_CONFIRMED_14)}))},ct=n(59),st=function(t){var e=t.data,n=t.dateRange,r=t.label,o=t.theme,i=t.zeroBased,c=O(n,e),s=Math.min.apply(Math,Object(_.a)(c.map((function(t){return t.count})))),u=Math.max.apply(Math,Object(_.a)(c.map((function(t){return t.count})))),d=Math.max((u-s)/20,i?4:2),l=Math.round(u+d),f=Math.round(s-d);return i&&(f=Math.max(f,0)),Object(a.jsx)(ct.Line,{data:Q(c,r,o),options:tt(i,f,l)})};st.defaultProps={zeroBased:!0,dateRange:0};var ut=st,_t=function(t){var e=t.dataArray,n=t.dateRange,r=t.labels,o=t.themes,i=t.zeroBased,c=e.map((function(t){return O(n,t)})),s=c.flatMap((function(t){return t.map((function(t){return t.count}))})),u=Math.min.apply(Math,Object(_.a)(s)),d=Math.max.apply(Math,Object(_.a)(s)),l=Math.max((d-u)/20,i?4:2),f=Math.round(d+l),g=Math.round(u-l);return i&&(g=Math.max(g,0)),e.length!==r.length||r.length!==o.length?(console.error("Chart arguments cardinality did not match!"),Object(a.jsx)(ct.Line,{options:tt(!1,g,f)})):Object(a.jsx)(ct.Line,{data:X(c,r,o),options:tt(i,g,f)})};_t.defaultProps={zeroBased:!0,dateRange:0};var dt=_t;function lt(t,e,n){var a=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},o="".concat(t,",").concat(e,",").concat(n);return Object(b.a)({backgroundColor:a?"rgba(".concat(o,",0.4)"):"rgba(0,0,0,0)",borderColor:"rgba(".concat(o,",1)"),pointBorderColor:"rgba(".concat(o,",1)"),pointHoverBackgroundColor:"rgba(".concat(o,",1)")},r)}lt(75,192,192);var ft=lt(75,192,192,!1),gt=lt(192,75,192),bt=lt(192,75,192,!1),ht=lt(217,128,217),jt=lt(140,83,140),Ot=lt(192,192,75),mt=lt(192,192,75,!1),Et=(lt(217,217,128),lt(140,140,83),lt(0,80,255),lt(0,80,255,!1)),pt=(lt(0,255,80),lt(0,255,80,!1)),vt=lt(255,80,30),Dt=lt(200,200,200,!1,{pointRadius:0,pointHitRadius:0,borderDash:[8]}),Ct=lt(20,20,20),At=lt(255,189,0,!1),Mt=lt(255,84,0,!1),xt=lt(158,0,89,!1),Nt=function(){var t=Y.useState((function(t){return t.styles})),e=Z.useState((function(t){return t.portugalEntries})),n=Z.useState((function(t){return t.dateRange}));return rt("Casos ativos",t,Object(a.jsx)(ut,{data:e.getAll(A.ACTIVE_PT),dateRange:n,label:"Casos ativos em Portugal",theme:gt,zeroBased:!0}),Object(a.jsx)(dt,{dataArray:[e.getAll(A.HOSPITALIZED_NURSERY),e.getAll(A.HOSPITALIZED_ICU)],dateRange:n,labels:["Internados em Enfermaria em Portugal","Internados em UCI em Portugal"],themes:[ht,jt],zeroBased:!0}))},It=function(){var t=Y.useState((function(t){return t.styles})),e=Z.useState((function(t){return t.portugalEntries})),n=Z.useState((function(t){return t.dateRange})),r=m(e.getAll(A.DEAD_PT));return rt("Evolu\xe7\xe3o em Portugal",t,Object(a.jsx)(dt,{dataArray:[e.getAll(A.NEWCASES_PT),E(e.getAll(A.NEWCASES_PT))],dateRange:n,labels:["Casos novos em Portugal",""],themes:[vt,Dt]}),Object(a.jsx)(dt,{dataArray:[r,E(r)],dateRange:n,labels:["Mortes em Portugal",""],themes:[Ct,Dt]}))},Rt=function(){var t=Y.useState((function(t){return t.styles})),e=Z.useState((function(t){return t.portugalEntries})),n=Z.useState((function(t){return t.dateRange})),r=m(e.getAll(A.CONFIRMED_NORTH)),o=m(e.getAll(A.CONFIRMED_CENTER)),i=m(e.getAll(A.CONFIRMED_LISBOA_TEJO)),c=m(e.getAll(A.CONFIRMED_ALENTEJO)),s=m(e.getAll(A.CONFIRMED_ALGARVE)),u=p(r,3689682),_=p(o,2327755),d=p(i,2821876),l=p(c,757302),f=p(s,451006);return rt("Evolu\xe7\xe3o regional",t,Object(a.jsx)(dt,{dataArray:[r,o,i,c,s],dateRange:n,labels:["Casos novos no Norte","Casos novos no Centro","Casos novos em Lisboa/V.Tejo","Casos novos no Alentejo","Casos novos no Algarve"],themes:[mt,bt,ft,Et,pt]}),Object(a.jsx)(dt,{dataArray:[u,_,d,l,f],dateRange:n,labels:["Incid\xeancia no Norte (a 1 dia p/ 100k hab.)","Incid\xeancia no Centro (a 1 dia p/ 100k hab.)","Incid\xeancia em Lisboa/V.Tejo (a 1 dia p/ 100k hab.)","Incid\xeancia no Alentejo (a 1 dia p/ 100k hab.)","Incid\xeancia no Algarve (a 1 dia p/ 100k hab.)"],themes:[mt,bt,ft,Et,pt]}))},yt=function(){var t,e=Y.useState((function(t){return t.styles})),n=Z.useState((function(t){return t.trofaEntries})),r=Z.useState((function(t){return t.dateRange})),o=(t=n.getAll(A.TOWN_INCIDENCE_14),function(e){return t.map((function(t){return new h(t.dateStr,e)}))});return rt("Evolu\xe7\xe3o na Trofa",e,Object(a.jsx)(dt,{dataArray:[n.getAll(A.TOWN_INCIDENCE_14),o(240),o(480),o(960)],dateRange:r,labels:["Incid\xeancia na Trofa (a 14 dias p/ 100k hab.)","Risco elevado","Risco muito elevado","Risco extremamente elevado"],themes:[Ot,At,Mt,xt]}))},St=Object(s.a)((function(){return{root:{backgroundColor:"#f5f5f5",flexGrow:1,"align-items":"center","justify-content":"center",padding:15,paddingRight:30},chartContainer:{position:"relative",margin:"auto",height:"50vh",width:"90vw"},progress:{float:"none",margin:"0 auto"},appBar:{maxWidth:500,marginBottom:20,backgroundColor:"#e0e0e0"},formControl:{margin:10}}}));var Ft=function(){var t=St();Y.update((function(e){e.styles=t}));var e=Object(r.useState)(!0),n=Object(c.a)(e,2),o=n[0],i=n[1],s=Z.useState((function(t){return t.portugalEntries})),_=Z.useState((function(t){return t.trofaEntries})),d="",l="",f=function(t){switch(t){case 0:return Object(a.jsxs)("div",{children:[Object(a.jsx)(Nt,{}),Object(a.jsx)("br",{}),Object(a.jsx)(yt,{}),Object(a.jsx)("br",{}),Object(a.jsx)(It,{}),Object(a.jsx)("br",{}),Object(a.jsx)(Rt,{})]});case 1:return Object(a.jsx)(it,{});default:return Object(a.jsx)("p",{children:"Bug? \xaf\\_(\u30c4)_/\xaf"})}}(Y.useState((function(t){return t.tab})));return Object(r.useEffect)((function(){!function(t,e){var n="data_concelhos_new.csv";F(n).then((function(t){if(t&&200===t.status)return t.text()})).then((function(a){var r=new N(n),o=new R.Readable;o.push(a),o.push(null),o.pipe(S()()).on("data",(function(e){return e.concelho===t&&Object.values(A).forEach((function(t){return e[t]&&r.addEntry(t,new h(e.data,e[t]))}))})).on("end",(function(){return e(r.build())}))})).catch((function(t){return console.error(t)}))}("TROFA",(function(t){return Z.update((function(e){e.trofaEntries=t}))})),function(t){var e="data.csv";F(e).then((function(t){if(t&&200===t.status)return t.text()})).then((function(n){var a=new I(e),r=new R.Readable;r.push(n),r.push(null),r.pipe(S()()).on("data",(function(t){Object.values(A).forEach((function(e){return t[e]&&a.addEntry(e,new h(t.data,t[e]))}))})).on("end",(function(){return t(a.build())}))})).catch((function(t){return console.error(t)}))}((function(t){return Z.update((function(e){e.portugalEntries=t}))}))}),[]),o||(d=_.getLast(A.TOWN_INCIDENCE_14).dateStr,l=s.getLast(A.CONFIRMED_PT).dateStr),o&&_.getAll(A.TOWN_INCIDENCE_14).length>0&&s.getAll(A.CONFIRMED_PT).length>0&&i(!1),Object(a.jsx)("div",{className:t.root,children:o?Object(a.jsx)(u.a,{className:t.progress}):Object(a.jsxs)("div",{children:[Object(a.jsx)(q,{}),Object(a.jsxs)(k,{children:["A \xfaltima atualiza\xe7\xe3o destes dados ocorreu nas seguintes datas: ","Portugal/Norte => ".concat(l,", Trofa => ").concat(d),"."]}),Object(a.jsx)("br",{}),f,Object(a.jsx)("br",{}),Object(a.jsx)($,{})]})})};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(Object(a.jsx)(Ft,{}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(t){t.unregister()}))}},[[258,1,2]]]);
//# sourceMappingURL=main.24f1b3dd.chunk.js.map