(this["webpackJsonpcovid19-trofa-graph"]=this["webpackJsonpcovid19-trofa-graph"]||[]).push([[0],{115:function(t,e,n){},118:function(t,e){},120:function(t,e){},243:function(t,e,n){"use strict";n.r(e);var a=n(3),r=n(0),o=n(8),i=n.n(o),s=(n(115),n(47)),c=n(282),u=n(281),l=n(20),d=n(105),g=n(104),h=n(31),j=n(32);var b=function(){function t(e,n){Object(h.a)(this,t),this._dateStr=void 0,this._date=void 0,this._count=void 0,this._dateStr=e,this._date=function(t){var e=t.split("-");return new Date(Number(e[2]),Number(e[1])-1,Number(e[0]))}(e),this._count="number"===typeof n?n:parseInt(n),isNaN(this._count)&&(this._count=0)}return Object(j.a)(t,[{key:"dateStr",get:function(){return this._dateStr}},{key:"date",get:function(){return this._date}},{key:"count",get:function(){return this._count}}]),t}(),f={CONFIRMED_PT:"confirmados",CONFIRMED_NORTH:"confirmados_arsnorte",CONFIRMED_CENTER:"confirmados_arscentro",CONFIRMED_LISBOA_TEJO:"confirmados_arslvt",CONFIRMED_ALENTEJO:"confirmados_arsalentejo",CONFIRMED_ALGARVE:"confirmados_arsalgarve",NEWCASES_PT:"confirmados_novos",ACTIVE_PT:"ativos",HOSPITALIZED:"internados",HOSPITALIZED_NURSERY:"internados_enfermaria",HOSPITALIZED_ICU:"internados_uci",TOWN_INCIDENCE_14:"incidencia",TOWN_CONFIRMED_14:"confirmados_14"},O=function(){function t(e){Object(h.a)(this,t),this._name=void 0,this._name=e}return Object(j.a)(t,[{key:"getAll",value:function(t){return console.warn("The EntriesAggregator '".concat(this._name,"' was not properly instantiated and is trying to call getAll!")),[]}},{key:"getLast",value:function(t){return console.warn("The EntriesAggregator '".concat(this._name,"' was not properly instantiated and is trying to call getLastEntry!")),new b("",0)}}]),t}(),p=function(t){Object(d.a)(n,t);var e=Object(g.a)(n);function n(t){var a;return Object(h.a)(this,n),(a=e.call(this,t.name))._aggregationMap=void 0,a._aggregationMap=t._aggregator,a}return Object(j.a)(n,[{key:"getAll",value:function(t){return this._aggregationMap[t]||[]}},{key:"getLast",value:function(t){var e=this._aggregationMap[t];return e[e.length-1]}}]),n}(O),v=function(){function t(e){Object(h.a)(this,t),this._name=void 0,this._aggregator=void 0,this._name=e,this._aggregator={}}return Object(j.a)(t,[{key:"addEntry",value:function(t,e){var n=this._aggregator[t]||[];return this._aggregator[t]=[].concat(Object(l.a)(n),[e]),this}},{key:"build",value:function(){return new p(this)}},{key:"name",get:function(){return this._name}}]),t}(),m=n(59),E=n(76),_=n.n(E);function C(t){var e="https://raw.githubusercontent.com/dssg-pt/covid19pt-data/master/"+t,n=new Headers({Accept:"application/vnd.github.v3+json"});return console.log("[_getDataFromSource] Fetching "+t),fetch(e,{method:"GET",headers:n})}var x=n(46),N=n(272),I=n(276);function R(t){var e=window.screen.availWidth,n=12*(t.length/e);return Math.max(4-n,1)}function A(t,e){var n=function(t){var e=new Date;return e.setDate(e.getDate()-t),e}(t);return e.filter((function(t){return t.date>=n}))}function T(t){for(var e=t[0],n=[new b(e.dateStr,0)],a=1;a<t.length;a++){var r=t[a];n.push(new b(r.dateStr,r.count-e.count)),e=r}return n}function y(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:7;return t.map((function(n,a){var r=Math.max(0,a-e),o=Math.min(t.length,a+e),i=t.slice(r,o),s=i.reduce((function(t,e){return t+e.count}),0);return new b(n.dateStr,Math.round(s/i.length))}))}var M=function(t,e,n){return{datasets:[Object(x.a)({label:e,categoryPercentage:1,barPercentage:.95,lineTension:.1,borderWidth:2,pointBackgroundColor:"#fff",pointHoverBorderColor:"rgba(220,220,220,1)",pointBorderWidth:1,pointHoverRadius:5,pointRadius:R(t),data:t.map((function(t){return t.count}))},n)],labels:t.map((function(t){return t.dateStr}))}},D=function(t,e,n){return{datasets:Array.from(Array(t.length).keys()).map((function(a){return Object(x.a)({label:e[a],categoryPercentage:1,barPercentage:.95,lineTension:.1,borderWidth:2,pointBackgroundColor:"#fff",pointHoverBorderColor:"rgba(220,220,220,1)",pointBorderWidth:1,pointHoverRadius:5,pointRadius:R(t[a]),data:t[a].map((function(t){return t.count}))},n[a])})),labels:t[0].map((function(t){return t.dateStr}))}},S=function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return{maintainAspectRatio:!1,scales:{yAxes:[{ticks:{beginAtZero:t,suggestedMin:e,suggestedMax:n}}]}}},w=function(t,e){return Object(a.jsx)(N.a,{item:!0,xs:6,md:3,children:t})},P=0,L=function(t,e){return Object(a.jsx)(N.a,{item:!0,xs:12,children:Object(a.jsx)("div",{className:e.chartContainer,children:t})},P++)},k=function(t,e){for(var n=arguments.length,r=new Array(n>2?n-2:0),o=2;o<n;o++)r[o-2]=arguments[o];return Object(a.jsxs)("div",{children:[Object(a.jsx)(I.a,{variant:"h3",style:{textAlign:"center"},gutterBottom:!0,children:t}),Object(a.jsx)(N.a,{container:!0,spacing:3,children:r.map((function(t){return L(t,e)}))})]})},B=n(45),F=function(t){var e=t.dataArray,n=t.dateRange,r=t.labels,o=t.themes,i=t.zeroBased,s=e.map((function(t){return A(n,t)})),c=s.flatMap((function(t){return t.map((function(t){return t.count}))})),u=Math.min.apply(Math,Object(l.a)(c)),d=Math.max.apply(Math,Object(l.a)(c)),g=Math.max((d-u)/20,i?4:2),h=Math.round(d+g),j=Math.round(u-g);return i&&(j=Math.max(j,0)),e.length!==r.length||r.length!==o.length?(console.error("Chart arguments cardinality did not match!"),Object(a.jsx)(B.Line,{options:S(!1,j,h)})):Object(a.jsx)(B.Line,{data:D(s,r,o),options:S(i,j,h)})};F.defaultProps={zeroBased:!0,dateRange:0};var W=F;function H(t,e,n){var a=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},o="".concat(t,",").concat(e,",").concat(n);return Object(x.a)({backgroundColor:a?"rgba(".concat(o,",0.4)"):"rgba(0,0,0,0)",borderColor:"rgba(".concat(o,",1)"),pointBorderColor:"rgba(".concat(o,",1)"),pointHoverBackgroundColor:"rgba(".concat(o,",1)")},r)}H(75,192,192);var U=H(75,192,192,!1),z=H(192,75,192),Z=H(192,75,192,!1),J=H(217,128,217),V=H(140,83,140),G=H(192,192,75),Y=H(192,192,75,!1),q=(H(217,217,128),H(140,140,83),H(0,80,255),H(0,80,255,!1)),$=(H(0,255,80),H(0,255,80,!1)),K=H(200,200,200,!1,{pointRadius:0,pointHitRadius:0,borderDash:[8]}),Q=H(255,189,0,!1),X=H(255,84,0,!1),tt=H(158,0,89,!1),et=function(t){var e,n=t.trofaEntries,r=t.ptEntries,o=t.dateRange,i=t.classes,s=(e=n.getAll(f.TOWN_INCIDENCE_14),function(t){return e.map((function(e){return new b(e.dateStr,t)}))}),c=T(r.getAll(f.CONFIRMED_NORTH)),u=T(r.getAll(f.CONFIRMED_CENTER)),l=T(r.getAll(f.CONFIRMED_LISBOA_TEJO)),d=T(r.getAll(f.CONFIRMED_ALENTEJO)),g=T(r.getAll(f.CONFIRMED_ALGARVE));return k("Casos novos",i,Object(a.jsx)(W,{dataArray:[n.getAll(f.TOWN_INCIDENCE_14),s(240),s(480),s(960)],dateRange:o,labels:["Incid\xeancia na Trofa (a 14 dias p/ 100k hab.)","Risco elevado","Risco muito elevado","Risco extremamente elevado"],themes:[G,Q,X,tt]}),Object(a.jsx)(W,{dataArray:[c,y(c)],dateRange:o,labels:["Casos novos no Norte",""],themes:[G,K]}),Object(a.jsx)(W,{dataArray:[c,u,l,d,g],dateRange:o,labels:["Casos novos no Norte","Casos novos no Centro","Casos novos em Lisboa/V.Tejo","Casos novos no Alentejo","Casos novos no Algarve"],themes:[Y,Z,U,q,$]}),Object(a.jsx)(W,{dataArray:[r.getAll(f.NEWCASES_PT),y(r.getAll(f.NEWCASES_PT))],dateRange:o,labels:["Casos novos em Portugal",""],themes:[G,K]}))},nt=function(t){var e=t.data,n=t.dateRange,r=t.label,o=t.theme,i=t.zeroBased,s=A(n,e),c=Math.min.apply(Math,Object(l.a)(s.map((function(t){return t.count})))),u=Math.max.apply(Math,Object(l.a)(s.map((function(t){return t.count})))),d=Math.max((u-c)/20,i?4:2),g=Math.round(u+d),h=Math.round(c-d);return i&&(h=Math.max(h,0)),Object(a.jsx)(B.Line,{data:M(s,r,o),options:S(i,h,g)})};nt.defaultProps={zeroBased:!0,dateRange:0};var at=nt,rt=function(t){var e=t.ptEntries,n=t.dateRange,r=t.classes;return k("Casos ativos",r,Object(a.jsx)(at,{data:e.getAll(f.ACTIVE_PT),dateRange:n,label:"Casos ativos em Portugal",theme:z,zeroBased:!0}),Object(a.jsx)(W,{dataArray:[e.getAll(f.HOSPITALIZED_NURSERY),e.getAll(f.HOSPITALIZED_ICU)],dateRange:n,labels:["Internados em Enfermaria em Portugal","Internados em UCI em Portugal"],themes:[J,V],zeroBased:!0}))},ot=n(277),it=n(278),st=function(t){var e=t.children;return Object(a.jsx)(ot.a,{children:Object(a.jsx)(it.a,{children:Object(a.jsx)(I.a,{variant:"body2",component:"p",children:e})})})},ct=n(279),ut=n(280),lt=n(285),dt=n(283),gt=n(284),ht=function(t){var e=t.classes,n=t.dateRange,r=t.setDateRange;return Object(a.jsx)(ct.a,{position:"sticky",className:e.appBar,children:Object(a.jsxs)(ut.a,{className:e.formControl,children:[Object(a.jsx)(lt.a,{id:"time-label",children:"Tempo"}),Object(a.jsxs)(dt.a,{labelId:"time-label",id:"time-select",value:n,onChange:function(t){return r(t.target.value)},children:[Object(a.jsx)(gt.a,{value:30,children:"30 dias"}),Object(a.jsx)(gt.a,{value:60,children:"60 dias"}),Object(a.jsx)(gt.a,{value:90,children:"90 dias"}),Object(a.jsx)(gt.a,{value:999999,children:"Desde sempre"})]})]})})},jt=function(){return Object(a.jsx)(ot.a,{children:Object(a.jsx)(it.a,{children:Object(a.jsxs)(I.a,{variant:"body2",component:"p",children:["Os dados aqui apresentados s\xe3o extra\xeddos do reposit\xf3rio ",Object(a.jsx)("a",{href:"https://github.com/dssg-pt/covid19pt-data",children:"dssg-pt/covid19pt-data"}),".",Object(a.jsx)("br",{}),"O c\xf3digo para este dashboard pode ser consultado ",Object(a.jsx)("a",{href:"https://github.com/DiogoDuque/covid19TrofaGraph",children:"aqui"}),".",Object(a.jsx)("br",{})]})})})},bt=function(t){var e=t.title,n=t.entry;return Object(a.jsx)(ot.a,{elevation:4,children:Object(a.jsxs)(it.a,{children:[Object(a.jsx)(I.a,{style:{fontSize:15,fontWeight:"bold"},color:"textSecondary",gutterBottom:!0,children:e}),Object(a.jsx)(I.a,{variant:"h5",component:"h2",children:n.count}),Object(a.jsx)(I.a,{style:{fontSize:11},color:"textSecondary",children:"\xdaltima atualiza\xe7\xe3o: ".concat(n.dateStr)})]})})},ft=function(t){var e=t.classes,n=t.ptEntries,r=t.trofaEntries;return function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return Object(a.jsx)(N.a,{container:!0,spacing:1,direction:"row",alignItems:"center",justify:"center",children:n.map((function(t){return w(t)}))})}(e,Object(a.jsx)(bt,{title:"Casos ativos em Portugal",entry:n.getLast(f.ACTIVE_PT)}),Object(a.jsx)(bt,{title:"Casos novos em Portugal",entry:n.getLast(f.NEWCASES_PT)}),Object(a.jsx)(bt,{title:"Incid\xeancia na Trofa",entry:r.getLast(f.TOWN_INCIDENCE_14)}))},Ot=Object(u.a)((function(){return{root:{backgroundColor:"#f5f5f5",flexGrow:1,display:"flex","align-items":"center","justify-content":"center",padding:15,paddingRight:30},chartContainer:{position:"relative",margin:"auto",height:"50vh",width:"90vw"},progress:{float:"none",margin:"0 auto"},appBar:{maxWidth:170,marginBottom:20,backgroundColor:"#e0e0e0"},formControl:{margin:10}}})),pt=function(){var t=Ot(),e=Object(r.useState)(!0),n=Object(s.a)(e,2),o=n[0],i=n[1],u=Object(r.useState)(60),l=Object(s.a)(u,2),d=l[0],g=l[1],h=Object(r.useState)(new O("DUMMY")),j=Object(s.a)(h,2),p=j[0],E=j[1],x=Object(r.useState)(new O("DUMMY")),N=Object(s.a)(x,2),I=N[0],R=N[1],A="",T="";return Object(r.useEffect)((function(){!function(t,e){var n="data_concelhos_new.csv";C(n).then((function(t){if(t&&200===t.status)return t.text()})).then((function(a){var r=new v(n),o=new m.Readable;o.push(a),o.push(null),o.pipe(_()()).on("data",(function(e){return e.concelho===t&&[f.TOWN_INCIDENCE_14,f.TOWN_CONFIRMED_14].forEach((function(t){return r.addEntry(t,new b(e.data,e[t]))}))})).on("end",(function(){return e(r.build())}))})).catch((function(t){return console.error(t)}))}("TROFA",E),function(t){var e="data.csv";C(e).then((function(t){if(t&&200===t.status)return t.text()})).then((function(n){var a=new v(e),r=new m.Readable;r.push(n),r.push(null),r.pipe(_()()).on("data",(function(t){[f.CONFIRMED_PT,f.CONFIRMED_NORTH,f.CONFIRMED_CENTER,f.CONFIRMED_LISBOA_TEJO,f.CONFIRMED_ALENTEJO,f.CONFIRMED_ALGARVE,f.NEWCASES_PT,f.ACTIVE_PT,f.HOSPITALIZED,f.HOSPITALIZED_NURSERY,f.HOSPITALIZED_ICU].forEach((function(e){return a.addEntry(e,new b(t.data,t[e]))}))})).on("end",(function(){return t(a.build())}))})).catch((function(t){return console.error(t)}))}(R)}),[]),o||(A=p.getLast(f.TOWN_INCIDENCE_14).dateStr,T=I.getLast(f.CONFIRMED_PT).dateStr),o&&p.getAll(f.TOWN_INCIDENCE_14).length>0&&I.getAll(f.CONFIRMED_PT).length>0&&i(!1),Object(a.jsx)("div",{className:t.root,children:o?Object(a.jsx)(c.a,{className:t.progress}):Object(a.jsxs)("div",{children:[Object(a.jsx)(ht,{classes:t,dateRange:d,setDateRange:g,lastPtUpdate:T,lastTownUpdate:A}),Object(a.jsxs)(st,{children:["A \xfaltima atualiza\xe7\xe3o destes dados ocorreu nas seguintes datas: ","Portugal/Norte => ".concat(T,", Trofa => ").concat(A),"."]}),Object(a.jsx)("br",{}),Object(a.jsx)(ft,{classes:t,ptEntries:I,trofaEntries:p}),Object(a.jsx)("br",{}),Object(a.jsx)(rt,{ptEntries:I,dateRange:d,classes:t}),Object(a.jsx)("br",{}),Object(a.jsx)(et,{trofaEntries:p,dateRange:d,ptEntries:I,classes:t}),Object(a.jsx)("br",{}),Object(a.jsx)(jt,{})]})})};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(Object(a.jsx)(pt,{}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(t){t.unregister()}))}},[[243,1,2]]]);
//# sourceMappingURL=main.d6dc4103.chunk.js.map