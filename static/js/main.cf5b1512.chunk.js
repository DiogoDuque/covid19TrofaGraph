(this["webpackJsonpcovid19-trofa-graph"]=this["webpackJsonpcovid19-trofa-graph"]||[]).push([[0],{115:function(t,e,a){},118:function(t,e){},120:function(t,e){},243:function(t,e,a){"use strict";a.r(e);var n=a(4),r=a(0),o=a(8),i=a.n(o),s=(a(115),a(46)),c=a(280),u=a(281),d=a(282),l=a(287),g=a(285),h=a(286),b=a(278),f=a(279),O=a(283),j=a(284),p=a(20),v=a(104),m=a(103),E=a(31),_=a(32);var C=function(){function t(e,a){Object(E.a)(this,t),this._dateStr=void 0,this._date=void 0,this._count=void 0,this._dateStr=e,this._date=function(t){var e=t.split("-");return new Date(Number(e[2]),Number(e[1])-1,Number(e[0]))}(e),this._count="number"===typeof a?a:parseInt(a),isNaN(this._count)&&(this._count=0)}return Object(_.a)(t,[{key:"dateStr",get:function(){return this._dateStr}},{key:"date",get:function(){return this._date}},{key:"count",get:function(){return this._count}}]),t}(),N={CONFIRMED_PT:"confirmados",CONFIRMED_NORTH:"confirmados_arsnorte",CONFIRMED_CENTER:"confirmados_arscentro",CONFIRMED_LISBOA_TEJO:"confirmados_arslvt",CONFIRMED_ALENTEJO:"confirmados_arsalentejo",CONFIRMED_ALGARVE:"confirmados_arsalgarve",NEWCASES_PT:"confirmados_novos",ACTIVE_PT:"ativos",HOSPITALIZED:"internados",HOSPITALIZED_NURSERY:"internados_enfermaria",HOSPITALIZED_ICU:"internados_uci",TOWN_INCIDENCE:"incidencia"},A=function(){function t(e){Object(E.a)(this,t),this._name=void 0,this._name=e}return Object(_.a)(t,[{key:"getAll",value:function(t){return console.warn("The EntriesAggregator '".concat(this._name,"' was not properly instantiated and is trying to call getAll!")),[]}},{key:"getLast",value:function(t){return console.warn("The EntriesAggregator '".concat(this._name,"' was not properly instantiated and is trying to call getLastEntry!")),new C("",0)}}]),t}(),I=function(t){Object(v.a)(a,t);var e=Object(m.a)(a);function a(t){var n;return Object(E.a)(this,a),(n=e.call(this,t.name))._aggregationMap=void 0,n._aggregationMap=t._aggregator,n}return Object(_.a)(a,[{key:"getAll",value:function(t){return this._aggregationMap[t]||[]}},{key:"getLast",value:function(t){var e=this._aggregationMap[t];return e[e.length-1]}}]),a}(A),R=function(){function t(e){Object(E.a)(this,t),this._name=void 0,this._aggregator=void 0,this._name=e,this._aggregator={}}return Object(_.a)(t,[{key:"addEntry",value:function(t,e){var a=this._aggregator[t]||[];return this._aggregator[t]=[].concat(Object(p.a)(a),[e]),this}},{key:"build",value:function(){return new I(this)}},{key:"name",get:function(){return this._name}}]),t}(),x=a(58),T=a(75),M=a.n(T);function y(t){var e="https://raw.githubusercontent.com/dssg-pt/covid19pt-data/master/"+t,a=new Headers({Accept:"application/vnd.github.v3+json"});return console.log("[_getDataFromSource] Fetching "+t),fetch(e,{method:"GET",headers:a})}var D=a(45),S=a(274);function w(t){var e=window.screen.availWidth,a=12*(t.length/e);return Math.max(4-a,1)}function P(t,e){var a=function(t){var e=new Date;return e.setDate(e.getDate()-t),e}(t);return e.filter((function(t){return t.date>=a}))}function L(t){for(var e=t[0],a=[new C(e.dateStr,0)],n=1;n<t.length;n++){var r=t[n];a.push(new C(r.dateStr,r.count-e.count)),e=r}return a}function k(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:7;return t.map((function(a,n){var r=Math.max(0,n-e),o=Math.min(t.length,n+e),i=t.slice(r,o),s=i.reduce((function(t,e){return t+e.count}),0);return new C(a.dateStr,Math.round(s/i.length))}))}var B=function(t,e,a){return{datasets:[Object(D.a)({label:e,categoryPercentage:1,barPercentage:.95,lineTension:.1,borderWidth:2,pointBackgroundColor:"#fff",pointHoverBorderColor:"rgba(220,220,220,1)",pointBorderWidth:1,pointHoverRadius:5,pointRadius:w(t),data:t.map((function(t){return t.count}))},a)],labels:t.map((function(t){return t.dateStr}))}},F=function(t,e,a){return{datasets:Array.from(Array(t.length).keys()).map((function(n){return Object(D.a)({label:e[n],categoryPercentage:1,barPercentage:.95,lineTension:.1,borderWidth:2,pointBackgroundColor:"#fff",pointHoverBorderColor:"rgba(220,220,220,1)",pointBorderWidth:1,pointHoverRadius:5,pointRadius:w(t[n]),data:t[n].map((function(t){return t.count}))},a[n])})),labels:t[0].map((function(t){return t.dateStr}))}},H=function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return{maintainAspectRatio:!1,scales:{yAxes:[{ticks:{beginAtZero:t,suggestedMin:e,suggestedMax:a}}]}}},W=0,U=function(t,e){return Object(n.jsx)(S.a,{item:!0,xs:12,children:Object(n.jsx)("div",{className:e.chartContainer,children:t})},W++)},Z=function(t,e){for(var a=arguments.length,r=new Array(a>2?a-2:0),o=2;o<a;o++)r[o-2]=arguments[o];return Object(n.jsxs)("div",{children:[Object(n.jsx)(b.a,{variant:"h3",style:{textAlign:"center"},gutterBottom:!0,children:t}),Object(n.jsx)(S.a,{container:!0,spacing:3,children:r.map((function(t){return U(t,e)}))})]})},J=a(44),z=function(t){var e=t.dataArray,a=t.dateRange,r=t.labels,o=t.themes,i=t.zeroBased,s=e.map((function(t){return P(a,t)})),c=s.flatMap((function(t){return t.map((function(t){return t.count}))})),u=Math.min.apply(Math,Object(p.a)(c)),d=Math.max.apply(Math,Object(p.a)(c)),l=Math.max((d-u)/20,i?4:2),g=Math.round(d+l),h=Math.round(u-l);return i&&(h=Math.max(h,0)),e.length!==r.length||r.length!==o.length?(console.error("Chart arguments cardinality did not match!"),Object(n.jsx)(J.Line,{options:H(!1,h,g)})):Object(n.jsx)(J.Line,{data:F(s,r,o),options:H(i,h,g)})};z.defaultProps={zeroBased:!0,dateRange:0};var V=z;function G(t,e,a){var n=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},o="".concat(t,",").concat(e,",").concat(a);return Object(D.a)({backgroundColor:n?"rgba(".concat(o,",0.4)"):"rgba(0,0,0,0)",borderColor:"rgba(".concat(o,",1)"),pointBorderColor:"rgba(".concat(o,",1)"),pointHoverBackgroundColor:"rgba(".concat(o,",1)")},r)}G(75,192,192);var Y=G(75,192,192,!1),q=G(192,75,192),$=G(192,75,192,!1),K=G(217,128,217),Q=G(140,83,140),X=G(192,192,75),tt=G(192,192,75,!1),et=(G(217,217,128),G(140,140,83),G(0,80,255),G(0,80,255,!1)),at=(G(0,255,80),G(0,255,80,!1)),nt=G(200,200,200,!1,{pointRadius:0,pointHitRadius:0,borderDash:[8]}),rt=G(255,189,0,!1),ot=G(255,84,0,!1),it=G(158,0,89,!1),st=function(t){var e,a=t.trofaEntries,r=t.ptEntries,o=t.dateRange,i=t.classes,s=(e=a.getAll(N.TOWN_INCIDENCE),function(t){return e.map((function(e){return new C(e.dateStr,t)}))}),c=L(r.getAll(N.CONFIRMED_NORTH)),u=L(r.getAll(N.CONFIRMED_CENTER)),d=L(r.getAll(N.CONFIRMED_LISBOA_TEJO)),l=L(r.getAll(N.CONFIRMED_ALENTEJO)),g=L(r.getAll(N.CONFIRMED_ALGARVE));return Z("Casos novos",i,Object(n.jsx)(V,{dataArray:[a.getAll(N.TOWN_INCIDENCE),s(240),s(480),s(960)],dateRange:o,labels:["Incid\xeancia na Trofa (a 14 dias p/ 100k hab.)","Risco elevado","Risco muito elevado","Risco extremamente elevado"],themes:[X,rt,ot,it]}),Object(n.jsx)(V,{dataArray:[c,k(c)],dateRange:o,labels:["Casos novos no Norte",""],themes:[X,nt]}),Object(n.jsx)(V,{dataArray:[c,u,d,l,g],dateRange:o,labels:["Casos novos no Norte","Casos novos no Centro","Casos novos em Lisboa/V.Tejo","Casos novos no Alentejo","Casos novos no Algarve"],themes:[tt,$,Y,et,at]}),Object(n.jsx)(V,{dataArray:[r.getAll(N.NEWCASES_PT),k(r.getAll(N.NEWCASES_PT))],dateRange:o,labels:["Casos novos em Portugal",""],themes:[X,nt]}))},ct=function(t){var e=t.data,a=t.dateRange,r=t.label,o=t.theme,i=t.zeroBased,s=P(a,e),c=Math.min.apply(Math,Object(p.a)(s.map((function(t){return t.count})))),u=Math.max.apply(Math,Object(p.a)(s.map((function(t){return t.count})))),d=Math.max((u-c)/20,i?4:2),l=Math.round(u+d),g=Math.round(c-d);return i&&(g=Math.max(g,0)),Object(n.jsx)(J.Line,{data:B(s,r,o),options:H(i,g,l)})};ct.defaultProps={zeroBased:!0,dateRange:0};var ut=ct,dt=function(t){var e=t.ptEntries,a=t.dateRange,r=t.classes;return Z("Casos ativos",r,Object(n.jsx)(ut,{data:e.getAll(N.ACTIVE_PT),dateRange:a,label:"Casos ativos em Portugal",theme:q,zeroBased:!0}),Object(n.jsx)(V,{dataArray:[e.getAll(N.HOSPITALIZED_NURSERY),e.getAll(N.HOSPITALIZED_ICU)],dateRange:a,labels:["Internados em Enfermaria em Portugal","Internados em UCI em Portugal"],themes:[K,Q],zeroBased:!0}))},lt=Object(f.a)((function(){return{root:{backgroundColor:"#f5f5f5",flexGrow:1,display:"flex","align-items":"center","justify-content":"center",padding:15,paddingRight:30},chartContainer:{position:"relative",margin:"auto",height:"50vh",width:"90vw"},progress:{float:"none",margin:"0 auto"},appBar:{maxWidth:170,marginBottom:20,backgroundColor:"#e0e0e0"},formControl:{margin:10}}})),gt=function(){var t=lt(),e=Object(r.useState)(!0),a=Object(s.a)(e,2),o=a[0],i=a[1],f=Object(r.useState)(60),p=Object(s.a)(f,2),v=p[0],m=p[1],E=Object(r.useState)(new A("DUMMY")),_=Object(s.a)(E,2),I=_[0],T=_[1],D=Object(r.useState)(new A("DUMMY")),S=Object(s.a)(D,2),w=S[0],P=S[1],L="",k="";return o||(L=I.getLast(N.TOWN_INCIDENCE).dateStr,k=w.getLast(N.CONFIRMED_PT).dateStr),Object(r.useEffect)((function(){!function(t,e){var a="data_concelhos_new.csv";y(a).then((function(t){if(t&&200===t.status)return t.text()})).then((function(n){var r=new R(a),o=new x.Readable;o.push(n),o.push(null),o.pipe(M()()).on("data",(function(e){return e.concelho===t&&r.addEntry(N.TOWN_INCIDENCE,new C(e.data,e.incidencia))})).on("end",(function(){return e(r.build())}))})).catch((function(t){return console.error(t)}))}("TROFA",T),function(t){var e="data.csv";y(e).then((function(t){if(t&&200===t.status)return t.text()})).then((function(a){var n=new R(e),r=new x.Readable;r.push(a),r.push(null),r.pipe(M()()).on("data",(function(t){[N.CONFIRMED_PT,N.CONFIRMED_NORTH,N.CONFIRMED_CENTER,N.CONFIRMED_LISBOA_TEJO,N.CONFIRMED_ALENTEJO,N.CONFIRMED_ALGARVE,N.NEWCASES_PT,N.ACTIVE_PT,N.HOSPITALIZED,N.HOSPITALIZED_NURSERY,N.HOSPITALIZED_ICU].forEach((function(e){return n.addEntry(e,new C(t.data,t[e]))}))})).on("end",(function(){return t(n.build())}))})).catch((function(t){return console.error(t)}))}(P)}),[]),o&&I.getAll(N.TOWN_INCIDENCE).length>0&&w.getAll(N.CONFIRMED_PT).length>0&&i(!1),Object(n.jsx)("div",{className:t.root,children:o?Object(n.jsx)(c.a,{className:t.progress}):Object(n.jsxs)("div",{children:[Object(n.jsx)(u.a,{position:"sticky",className:t.appBar,children:Object(n.jsxs)(d.a,{className:t.formControl,children:[Object(n.jsx)(l.a,{id:"time-label",children:"Tempo"}),Object(n.jsxs)(g.a,{labelId:"time-label",id:"time-select",value:v,onChange:function(t){return m(t.target.value)},children:[Object(n.jsx)(h.a,{value:30,children:"30 dias"}),Object(n.jsx)(h.a,{value:60,children:"60 dias"}),Object(n.jsx)(h.a,{value:90,children:"90 dias"}),Object(n.jsx)(h.a,{value:999999,children:"Desde sempre"})]})]})}),Object(n.jsx)(O.a,{children:Object(n.jsx)(j.a,{children:Object(n.jsxs)(b.a,{variant:"body2",component:"p",children:["A \xfaltima atualiza\xe7\xe3o destes dados ocorreu nas seguintes datas: ","Portugal/Norte => ".concat(k,", Trofa => ").concat(L),".",Object(n.jsx)("br",{})]})})}),Object(n.jsx)("br",{}),Object(n.jsx)(dt,{ptEntries:w,dateRange:v,classes:t}),Object(n.jsx)("br",{}),Object(n.jsx)(st,{trofaEntries:I,dateRange:v,ptEntries:w,classes:t}),Object(n.jsx)("br",{}),Object(n.jsx)(O.a,{children:Object(n.jsx)(j.a,{children:Object(n.jsxs)(b.a,{variant:"body2",component:"p",children:["Os dados aqui apresentados s\xe3o extra\xeddos do reposit\xf3rio ",Object(n.jsx)("a",{href:"https://github.com/dssg-pt/covid19pt-data",children:"dssg-pt/covid19pt-data"}),".",Object(n.jsx)("br",{}),"O c\xf3digo para este dashboard pode ser consultado ",Object(n.jsx)("a",{href:"https://github.com/DiogoDuque/covid19TrofaGraph",children:"aqui"}),".",Object(n.jsx)("br",{})]})})})]})})};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(Object(n.jsx)(gt,{}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(t){t.unregister()}))}},[[243,1,2]]]);
//# sourceMappingURL=main.cf5b1512.chunk.js.map