(this["webpackJsonpcovid19-trofa-graph"]=this["webpackJsonpcovid19-trofa-graph"]||[]).push([[0],{113:function(t,e,n){},116:function(t,e){},118:function(t,e){},241:function(t,e,n){"use strict";n.r(e);var a=n(5),r=n(0),o=n(8),i=n.n(o),c=(n(113),n(44)),s=n(278),d=n(279),u=n(280),h=n(285),l=n(283),f=n(284),b=n(276),g=n(277),p=n(281),j=n(282),m=n(56),v=n(57),O=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[],i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[];Object(m.a)(this,t),this._confirmedPt=void 0,this._confirmedNorth=void 0,this._newConfirmedPt=void 0,this._activePt=void 0,this._hospitalized=void 0,this._icu=void 0,this._confirmedPt=e,this._confirmedNorth=n,this._newConfirmedPt=a,this._activePt=r,this._hospitalized=o,this._icu=i}return Object(v.a)(t,[{key:"confirmedPt",get:function(){return this._confirmedPt}},{key:"confirmedNorth",get:function(){return this._confirmedNorth}},{key:"newConfirmedPt",get:function(){return this._newConfirmedPt}},{key:"activePt",get:function(){return this._activePt}},{key:"hospitalized",get:function(){return this._hospitalized}},{key:"hospitalizedIcu",get:function(){return this._icu}}]),t}(),x=n(58),w=n(75),y=n.n(w);var _=function(){function t(e,n){Object(m.a)(this,t),this._dateStr=void 0,this._date=void 0,this._count=void 0,this._dateStr=e,this._date=function(t){var e=t.split("-");return new Date(Number(e[2]),Number(e[1])-1,Number(e[0]))}(e),this._count="number"===typeof n?n:parseInt(n),isNaN(this._count)&&(this._count=0)}return Object(v.a)(t,[{key:"dateStr",get:function(){return this._dateStr}},{key:"date",get:function(){return this._date}},{key:"count",get:function(){return this._count}}]),t}();function P(t){var e="https://raw.githubusercontent.com/dssg-pt/covid19pt-data/master/"+t,n=new Headers({Accept:"application/vnd.github.v3+json"});return console.log("[_getDataFromSource] Fetching "+t),fetch(e,{method:"GET",headers:n})}var C=n(43),R=n(272);function k(t){var e=window.screen.availWidth,n=12*(t.length/e);return Math.max(4-n,1)}function M(t,e){var n=function(t){var e=new Date;return e.setDate(e.getDate()-t),e}(t);return e.filter((function(t){return t.date>=n}))}function B(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:7;return t.map((function(n,a){var r=Math.max(0,a-e),o=Math.min(t.length,a+e),i=t.slice(r,o),c=i.reduce((function(t,e){return t+e.count}),0);return new _(n.dateStr,Math.round(c/i.length))}))}var N=function(t,e,n){return{datasets:[Object(C.a)({label:e,categoryPercentage:1,barPercentage:.95,lineTension:.1,borderWidth:2,pointBackgroundColor:"#fff",pointHoverBorderColor:"rgba(220,220,220,1)",pointBorderWidth:1,pointHoverRadius:5,pointRadius:k(t),data:t.map((function(t){return t.count}))},n)],labels:t.map((function(t){return t.dateStr}))}},S=function(t,e,n){return{datasets:Array.from(Array(t.length).keys()).map((function(a){return Object(C.a)({label:e[a],categoryPercentage:1,barPercentage:.95,lineTension:.1,borderWidth:2,pointBackgroundColor:"#fff",pointHoverBorderColor:"rgba(220,220,220,1)",pointBorderWidth:1,pointHoverRadius:5,pointRadius:k(t[a]),data:t[a].map((function(t){return t.count}))},n[a])})),labels:t[0].map((function(t){return t.dateStr}))}},A=function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return{maintainAspectRatio:!1,scales:{yAxes:[{ticks:{beginAtZero:t,suggestedMin:e,suggestedMax:n}}]}}},z=0,E=function(t,e){return Object(a.jsx)(R.a,{item:!0,xs:12,children:Object(a.jsx)("div",{className:e.chartContainer,children:t})},z++)},D=function(t,e){for(var n=arguments.length,r=new Array(n>2?n-2:0),o=2;o<n;o++)r[o-2]=arguments[o];return Object(a.jsxs)("div",{children:[Object(a.jsx)(b.a,{variant:"h3",style:{textAlign:"center"},gutterBottom:!0,children:t}),Object(a.jsx)(R.a,{container:!0,spacing:3,children:r.map((function(t){return E(t,e)}))})]})},I=n(34),T=n(42),W=function(t){var e=t.dataArray,n=t.dateRange,r=t.labels,o=t.themes,i=t.zeroBased,c=e.map((function(t){return M(n,t)})),s=c.flatMap((function(t){return t.map((function(t){return t.count}))})),d=Math.min.apply(Math,Object(I.a)(s)),u=Math.max.apply(Math,Object(I.a)(s)),h=Math.max((u-d)/20,i?4:2),l=Math.round(u+h),f=Math.round(d-h);return i&&(f=Math.max(f,0)),e.length!==r.length||r.length!==o.length?(console.error("Chart arguments cardinality did not match!"),Object(a.jsx)(T.Line,{options:A(!1,f,l)})):Object(a.jsx)(T.Line,{data:S(c,r,o),options:A(i,f,l)})};W.defaultProps={zeroBased:!0,dateRange:0};var H=W;function q(t,e,n){var a=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},o="".concat(t,",").concat(e,",").concat(n);return Object(C.a)({backgroundColor:a?"rgba(".concat(o,",0.4)"):"rgba(0,0,0,0)",borderColor:"rgba(".concat(o,",1)"),pointBorderColor:"rgba(".concat(o,",1)"),pointHoverBackgroundColor:"rgba(".concat(o,",1)")},r)}q(75,192,192);var F=q(192,75,192),G=q(217,128,217),L=q(140,83,140),J=q(192,192,75),U=q(200,200,200,!1,{pointRadius:0,pointHitRadius:0,borderDash:[8]}),Z=q(255,189,0,!1),$=q(255,84,0,!1),K=q(158,0,89,!1),Q=function(t){var e,n=t.trofaEntries,r=t.northEntries,o=t.ptEntries,i=t.dateRange,c=t.classes,s=(e=n,function(t){return e.map((function(e){return new _(e.dateStr,t)}))});return D("Casos novos",c,Object(a.jsx)(H,{dataArray:[n,s(240),s(480),s(960)],dateRange:i,labels:["Incid\xeancia na Trofa (a 14 dias p/ 100k hab.)","Risco elevado","Risco muito elevado","Risco extremamente elevado"],themes:[J,Z,$,K]}),Object(a.jsx)(H,{dataArray:[r,B(r)],dateRange:i,labels:["Casos novos no Norte",""],themes:[J,U]}),Object(a.jsx)(H,{dataArray:[o.newConfirmedPt,B(o.newConfirmedPt)],dateRange:i,labels:["Casos novos em Portugal",""],themes:[J,U]}))},V=function(t){var e=t.data,n=t.dateRange,r=t.label,o=t.theme,i=t.zeroBased,c=M(n,e),s=Math.min.apply(Math,Object(I.a)(c.map((function(t){return t.count})))),d=Math.max.apply(Math,Object(I.a)(c.map((function(t){return t.count})))),u=Math.max((d-s)/20,i?4:2),h=Math.round(d+u),l=Math.round(s-u);return i&&(l=Math.max(l,0)),Object(a.jsx)(T.Line,{data:N(c,r,o),options:A(i,l,h)})};V.defaultProps={zeroBased:!0,dateRange:0};var X=V,Y=function(t){var e=t.ptEntries,n=t.dateRange,r=t.classes;return D("Casos ativos",r,Object(a.jsx)(X,{data:e.activePt,dateRange:n,label:"Casos ativos em Portugal",theme:F,zeroBased:!0}),Object(a.jsx)(H,{dataArray:[e.hospitalized,e.hospitalizedIcu],dateRange:n,labels:["Internados em Portugal","Internados em UCI em Portugal"],themes:[G,L],zeroBased:!0}))},tt=Object(g.a)((function(){return{root:{backgroundColor:"#f5f5f5",flexGrow:1,display:"flex","align-items":"center","justify-content":"center",padding:15,paddingRight:30},chartContainer:{position:"relative",margin:"auto",height:"50vh",width:"90vw"},progress:{float:"none",margin:"0 auto"},appBar:{maxWidth:170,marginBottom:20,backgroundColor:"#e0e0e0"},formControl:{margin:10}}})),et=function(){var t=tt(),e=Object(r.useState)(!0),n=Object(c.a)(e,2),o=n[0],i=n[1],g=Object(r.useState)(60),m=Object(c.a)(g,2),v=m[0],w=m[1],C=Object(r.useState)([]),R=Object(c.a)(C,2),k=R[0],M=R[1],B=Object(r.useState)(new O),N=Object(c.a)(B,2),S=N[0],A=N[1],z="",E="",D=[];return o||(z=k[k.length-1].dateStr,E=S.confirmedPt[S.confirmedPt.length-1].dateStr,D=function(t){for(var e=t[0],n=[new _(e.dateStr,0)],a=1;a<t.length;a++){var r=t[a];n.push(new _(r.dateStr,r.count-e.count)),e=r}return n}(S.confirmedNorth)),Object(r.useEffect)((function(){var t,e;t="TROFA",e=M,P("data_concelhos_incidencia.csv").then((function(t){if(t&&200===t.status)return t.text()})).then((function(n){var a=[],r=new x.Readable;r.push(n),r.push(null),r.pipe(y()()).on("data",(function(e){return a.push(new _(e.data,e[t]))})).on("end",(function(){return e(a)}))})).catch((function(t){return console.error(t)})),function(t){P("data.csv").then((function(t){if(t&&200===t.status)return t.text()})).then((function(e){var n=[],a=[],r=[],o=[],i=[],c=[],s=new x.Readable;s.push(e),s.push(null),s.pipe(y()()).on("data",(function(t){n.push(new _(t.data,t.confirmados)),a.push(new _(t.data,t.confirmados_arsnorte)),r.push(new _(t.data,t.confirmados_novos)),o.push(new _(t.data,t.ativos)),i.push(new _(t.data,t.internados)),c.push(new _(t.data,t.internados_uci))})).on("end",(function(){return t(new O(n,a,r,o,i,c))}))})).catch((function(t){return console.error(t)}))}(A)}),[]),o&&k.length>0&&S.confirmedPt.length>0&&i(!1),Object(a.jsx)("div",{className:t.root,children:o?Object(a.jsx)(s.a,{className:t.progress}):Object(a.jsxs)("div",{children:[Object(a.jsx)(d.a,{position:"sticky",className:t.appBar,children:Object(a.jsxs)(u.a,{className:t.formControl,children:[Object(a.jsx)(h.a,{id:"time-label",children:"Tempo"}),Object(a.jsxs)(l.a,{labelId:"time-label",id:"time-select",value:v,onChange:function(t){return w(t.target.value)},children:[Object(a.jsx)(f.a,{value:30,children:"30 dias"}),Object(a.jsx)(f.a,{value:60,children:"60 dias"}),Object(a.jsx)(f.a,{value:90,children:"90 dias"}),Object(a.jsx)(f.a,{value:999999,children:"Desde sempre"})]})]})}),Object(a.jsx)(p.a,{children:Object(a.jsx)(j.a,{children:Object(a.jsxs)(b.a,{variant:"body2",component:"p",children:["A \xfaltima atualiza\xe7\xe3o destes dados ocorreu nas seguintes datas: ","Portugal/Norte => ".concat(E,", Trofa => ").concat(z),".",Object(a.jsx)("br",{})]})})}),Object(a.jsx)("br",{}),Object(a.jsx)(Y,{ptEntries:S,dateRange:v,classes:t}),Object(a.jsx)("br",{}),Object(a.jsx)(Q,{trofaEntries:k,dateRange:v,northEntries:D,ptEntries:S,classes:t}),Object(a.jsx)("br",{}),Object(a.jsx)(p.a,{children:Object(a.jsx)(j.a,{children:Object(a.jsxs)(b.a,{variant:"body2",component:"p",children:["Os dados aqui apresentados s\xe3o extra\xeddos do reposit\xf3rio ",Object(a.jsx)("a",{href:"https://github.com/dssg-pt/covid19pt-data",children:"dssg-pt/covid19pt-data"}),".",Object(a.jsx)("br",{}),"O c\xf3digo para este dashboard pode ser consultado ",Object(a.jsx)("a",{href:"https://github.com/DiogoDuque/covid19TrofaGraph",children:"aqui"}),".",Object(a.jsx)("br",{})]})})})]})})};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(Object(a.jsx)(et,{}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(t){t.unregister()}))}},[[241,1,2]]]);
//# sourceMappingURL=main.e2d54a13.chunk.js.map